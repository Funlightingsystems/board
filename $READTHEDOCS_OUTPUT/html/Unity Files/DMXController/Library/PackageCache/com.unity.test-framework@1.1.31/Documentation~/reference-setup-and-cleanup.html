<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Setup and cleanup at build time &#8212; Board 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/classic.css" />
    
    <script data-url_root="../../../../../../" id="documentation_options" src="../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../_static/doctools.js"></script>
    <script src="../../../../../../_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../../../../index.html">Board 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Setup and cleanup at build time</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="setup-and-cleanup-at-build-time">
<h1>Setup and cleanup at build time<a class="headerlink" href="#setup-and-cleanup-at-build-time" title="Permalink to this heading">¶</a></h1>
<p>In some cases, it is relevant to perform changes to Unity or the file system before building the tests. In the same way, it may be necessary to clean up such changes after the test run. In response to such needs, you can incorporate the pre-build setup and post-build cleanup concepts into your tests in one of the following ways:</p>
<ol class="arabic simple">
<li><p>Via implementation of <code class="docutils literal notranslate"><span class="pre">IPrebuildSetup</span></code> and <code class="docutils literal notranslate"><span class="pre">IPostBuildCleanup</span></code> interfaces by a test class.</p></li>
<li><p>Via applying the <code class="docutils literal notranslate"><span class="pre">PrebuildSetup</span></code> attribute and <code class="docutils literal notranslate"><span class="pre">PostBuildCleanup</span></code> attribute on your test class, one of the tests or the test assembly, providing a class name that implements the corresponding interface as an argument (fx <code class="docutils literal notranslate"><span class="pre">[PrebuildSetup(&quot;MyTestSceneSetup&quot;)]</span></code>).</p></li>
</ol>
<section id="execution-order">
<h2>Execution order<a class="headerlink" href="#execution-order" title="Permalink to this heading">¶</a></h2>
<p>All setups run in a deterministic order one after another. The first to run are the setups defined with attributes. Then any test class implementing the interface runs, in alphabetical order inside their namespace, which is the same order as the tests run.</p>
<blockquote>
<div><p><strong>Note</strong>: Cleanup runs right away for a standalone test run, but only after related tests run in the Unity Editor.</p>
</div></blockquote>
</section>
<section id="prebuildsetup-and-postbuildcleanup">
<h2>PrebuildSetup and PostBuildCleanup<a class="headerlink" href="#prebuildsetup-and-postbuildcleanup" title="Permalink to this heading">¶</a></h2>
<p>Both <code class="docutils literal notranslate"><span class="pre">PrebuildSetup</span></code> and <code class="docutils literal notranslate"><span class="pre">PostBuildCleanup</span></code> attributes run if the respective test or test class is in the current test run. The test is included either by running all tests or setting a <a class="reference internal" href="workflow-create-test.html#filters"><span class="std std-ref">filter</span></a> that includes the test. If multiple tests reference the same pre-built setup or post-build cleanup, then it only runs once.</p>
</section>
<section id="iprebuildsetup">
<h2>IPrebuildSetup<a class="headerlink" href="#iprebuildsetup" title="Permalink to this heading">¶</a></h2>
<p>Implement this interface if you want to define a set of actions to run as a pre-build step.</p>
<section id="public-methods">
<h3>Public methods<a class="headerlink" href="#public-methods" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Syntax</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">Setup()</span></code></p></td>
<td><p>Implement this method to call actions automatically before the build process.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ipostbuildcleanup">
<h2>IPostBuildCleanup<a class="headerlink" href="#ipostbuildcleanup" title="Permalink to this heading">¶</a></h2>
<p>Implement this interface if you want to define a set of actions to execute as a post-build step. Cleanup runs right away for a standalone test run, but only after all the tests run within the Editor.</p>
<section id="id1">
<h3>Public methods<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Syntax</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">Cleanup()</span></code></p></td>
<td><p>Implement this method to specify actions that should run as a post-build cleanup step.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="na">[TestFixture]</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">CreateSpriteTest</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IPrebuildSetup</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Texture2D</span><span class="w"> </span><span class="n">m_Texture</span><span class="p">;</span>
<span class="w">    </span><span class="n">Sprite</span><span class="w"> </span><span class="n">m_Sprite</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Setup</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>

<span class="cp">#if UNITY_EDITOR</span>

<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">spritePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Assets/Resources/Circle.png&quot;</span><span class="p">;</span>

<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UnityEditor</span><span class="p">.</span><span class="n">AssetImporter</span><span class="p">.</span><span class="n">GetAtPath</span><span class="p">(</span><span class="n">spritePath</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">UnityEditor</span><span class="p">.</span><span class="n">TextureImporter</span><span class="p">;</span>

<span class="w">        </span><span class="n">ti</span><span class="p">.</span><span class="n">textureCompression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UnityEditor</span><span class="p">.</span><span class="n">TextureImporterCompression</span><span class="p">.</span><span class="n">Uncompressed</span><span class="p">;</span>

<span class="w">        </span><span class="n">ti</span><span class="p">.</span><span class="n">SaveAndReimport</span><span class="p">();</span>

<span class="cp">#endif</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="na">[SetUp]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">SetUpTest</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">m_Texture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="o">&lt;</span><span class="n">Texture2D</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;Circle&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="na">[Test]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">WhenNullTextureIsPassed_CreateShouldReturnNullSprite</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// Check with Valid Texture.</span>

<span class="w">        </span><span class="n">LogAssert</span><span class="p">.</span><span class="n">Expect</span><span class="p">(</span><span class="n">LogType</span><span class="p">.</span><span class="n">Log</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Circle Sprite Created&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">Sprite</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">m_Texture</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Rect</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">m_Texture</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">m_Texture</span><span class="p">.</span><span class="n">height</span><span class="p">),</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="m">0.5f</span><span class="p">,</span><span class="w"> </span><span class="m">0.5f</span><span class="p">));</span>

<span class="w">        </span><span class="n">Debug</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&quot;Circle Sprite Created&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Check with NULL Texture. Should return NULL Sprite.</span>

<span class="w">        </span><span class="n">m_Sprite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sprite</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Rect</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">m_Texture</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">m_Texture</span><span class="p">.</span><span class="n">height</span><span class="p">),</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="m">0.5f</span><span class="p">,</span><span class="w"> </span><span class="m">0.5f</span><span class="p">));</span>

<span class="w">        </span><span class="n">Assert</span><span class="p">.</span><span class="n">That</span><span class="p">(</span><span class="n">m_Sprite</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="n">Null</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Sprite created with null texture should be null&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Tip</strong>: Use <code class="docutils literal notranslate"><span class="pre">#if</span> <span class="pre">UNITY_EDITOR</span></code> if you want to access Editor only APIs, but the setup/cleanup is inside a <strong>Play Mode</strong> assembly.</p>
</div></blockquote>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../../../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Setup and cleanup at build time</a><ul>
<li><a class="reference internal" href="#execution-order">Execution order</a></li>
<li><a class="reference internal" href="#prebuildsetup-and-postbuildcleanup">PrebuildSetup and PostBuildCleanup</a></li>
<li><a class="reference internal" href="#iprebuildsetup">IPrebuildSetup</a><ul>
<li><a class="reference internal" href="#public-methods">Public methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ipostbuildcleanup">IPostBuildCleanup</a><ul>
<li><a class="reference internal" href="#id1">Public methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../../../_sources/Unity Files/DMXController/Library/PackageCache/com.unity.test-framework@1.1.31/Documentation~/reference-setup-and-cleanup.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../../../../index.html">Board 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Setup and cleanup at build time</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, The FLS team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
  </body>
</html>